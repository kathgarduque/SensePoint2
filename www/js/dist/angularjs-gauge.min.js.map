{"version":3,"sources":["angularjs-gauge.js"],"names":["angular","gaugeMeterProviderFn","defaultOptions","size","value","undefined","cap","thick","type","foregroundColor","backgroundColor","duration","this","setOptions","customOptions","isObject","Error","merge","ngGauge","getOptions","extend","$get","gaugeMeterDirective","tpl","Gauge","element","options","find","text","legend","unit","context","getContext","init","prototype","setupStyles","create","canvas","width","height","lineCap","lineWidth","lfs","llh","css","display","fontWeight","position","textAlign","overflow","textOverflow","fontSize","lineHeight","textDecoration","opacity","fs","lh","parseInt","animate","timestamp","Date","getTime","runtime","starttime","progress","Math","min","self","drawShell","head","displacement","tail","requestID","window","requestAnimationFrame","cancelAnimationFrame","getType","bounds","getBounds","getDuration","clamp","getValue","PI","start","middle","center","getCenter","radius","getRadius","getForegroundColor","getBackgroundColor","clear","beginPath","strokeStyle","arc","x","y","stroke","clearRect","getWidth","getHeight","update","destroy","getThickness","val","used","total","getLineCap","max","restrict","replace","template","scope","append","label","prepend","link","watchData","nv","ov","gauge","equals","watchOther","defaults","isDefined","$watch","$on","module","directive","provider","$inject"],"mappings":"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","file":"angularjs-gauge.min.js","sourcesContent":["(function (angular) {\r\n    'use strict';\r\n    angular\r\n        .module('angularjs-gauge', [])\r\n        .directive('ngGauge', gaugeMeterDirective)\r\n        .provider('ngGauge', gaugeMeterProviderFn);\r\n\r\n    gaugeMeterProviderFn.$inject = [];\r\n    function gaugeMeterProviderFn() {\r\n        var defaultOptions = {\r\n            size: 200,\r\n            value: undefined,\r\n            cap: 'butt',\r\n            thick: 6,\r\n            type: 'full',\r\n            foregroundColor: 'rgba(0, 150, 136, 1)',\r\n            backgroundColor: 'rgba(0, 0, 0, 0.1)',\r\n            duration: 1500\r\n        };\r\n\r\n        this.setOptions = function (customOptions) {\r\n            if (!(customOptions && angular.isObject(customOptions)))\r\n                throw new Error('Invalid option type specified in the ngGaugeProvider');\r\n            defaultOptions = angular.merge(defaultOptions, customOptions);\r\n        };\r\n\r\n        var ngGauge = {\r\n            getOptions: function () {\r\n                return angular.extend({}, defaultOptions);\r\n            }\r\n        };\r\n\r\n        this.$get = function () {\r\n            return ngGauge;\r\n\r\n        };\r\n\r\n    }\r\n\r\n    gaugeMeterDirective.$inject = ['ngGauge'];\r\n\r\n    function gaugeMeterDirective(ngGauge) {\r\n\r\n        var tpl = '<div style=\"display:inline-block;text-align:center;position:relative;\"><span><u>{{prepend}}</u>{{value}}<u>{{append}}</u></span><b>{{label}}</b><canvas></canvas></div>';\r\n\r\n        var Gauge = function (element, options) {\r\n            this.element = element.find('canvas')[0];\r\n            this.text = element.find('span');\r\n            this.legend = element.find('b');\r\n            this.unit = element.find('u');\r\n            this.context = this.element.getContext('2d');\r\n            this.options = options;\r\n            this.init();\r\n        };\r\n\r\n        Gauge.prototype = {\r\n\r\n            init: function () {\r\n                this.setupStyles();\r\n                this.create();\r\n            },\r\n\r\n            setupStyles: function () {\r\n\r\n                this.context.canvas.width = this.options.size;\r\n                this.context.canvas.height = this.options.size;\r\n                this.context.lineCap = this.options.cap;\r\n                this.context.lineWidth = this.options.thick;\r\n\r\n                var lfs = this.options.size * 0.22,\r\n                    llh = this.options.size;\r\n\r\n                this.text.css({\r\n                    display: 'inline-block',\r\n                    fontWeight: 'normal',\r\n                    width: '100%',\r\n                    position: 'absolute',\r\n                    textAlign: 'center',\r\n                    overflow: 'hidden',\r\n                    textOverflow: 'ellipsis',\r\n                    fontSize: lfs + 'px',\r\n                    lineHeight: llh + 'px'\r\n                });\r\n\r\n                this.unit.css({\r\n                    textDecoration: 'none',\r\n                    fontSize: '0.6em',\r\n                    fontWeight: 200,\r\n                    opacity: 0.8\r\n                });\r\n\r\n                var fs = this.options.size / 13;\r\n                var lh = (5 * fs) + parseInt(this.options.size);\r\n\r\n                this.legend.css({\r\n                    display: 'inline-block',\r\n                    width: '100%',\r\n                    position: 'absolute',\r\n                    textAlign: 'center',\r\n                    overflow: 'hidden',\r\n                    textOverflow: 'ellipsis',\r\n                    fontWeight: 'normal',\r\n                    fontSize: fs + 'px',\r\n                    lineHeight: lh + 'px'\r\n                });\r\n            },\r\n            create: function () {\r\n\r\n                var self = this,\r\n                    type = this.getType(),\r\n                    bounds = this.getBounds(type),\r\n                    duration = this.getDuration(),\r\n                    value = this.clamp(this.getValue(), 0, 100),\r\n                    requestID,\r\n                    head = bounds.head,\r\n                    unit = (bounds.tail - bounds.head) / 100,\r\n                    displacement = unit * value,\r\n                    tail = bounds.tail,\r\n                    starttime;\r\n\r\n                function animate(timestamp) {\r\n                    var timestamp = timestamp || new Date().getTime();\r\n                    var runtime = timestamp - starttime;\r\n                    var progress = runtime / duration;\r\n                    progress = Math.min(progress, 1);\r\n\r\n                    self.drawShell(head, head + displacement * progress, tail);\r\n                    if (runtime < duration) {\r\n                        requestID = window.requestAnimationFrame(function (timestamp) {\r\n                            animate(timestamp);\r\n                        });\r\n                    } else {\r\n                        cancelAnimationFrame(requestID);\r\n                    }\r\n                }\r\n\r\n                requestAnimationFrame(function (timestamp) {\r\n                    starttime = timestamp || new Date().getTime();\r\n                    animate(timestamp);\r\n                });\r\n\r\n            },\r\n\r\n            getBounds: function (type) {\r\n                var head, tail;\r\n                if (type == 'semi') {\r\n                    head = Math.PI;\r\n                    tail = 2 * Math.PI;\r\n                } else if (type == 'full') {\r\n                    head = 1.5 * Math.PI;\r\n                    tail = 3.5 * Math.PI;\r\n                } else if (type === 'arch') {\r\n                    head = 0.8 * Math.PI;\r\n                    tail = 2.2 * Math.PI;\r\n                }\r\n\r\n                return {\r\n                    head: head,\r\n                    tail: tail\r\n                };\r\n\r\n            },\r\n\r\n            drawShell: function (start, middle, tail) {\r\n                var\r\n                    context = this.context,\r\n                    center = this.getCenter(),\r\n                    radius = this.getRadius(),\r\n                    foregroundColor = this.getForegroundColor(),\r\n                    backgroundColor = this.getBackgroundColor();\r\n                this.clear();\r\n                context.beginPath();\r\n                context.strokeStyle = backgroundColor;\r\n                context.arc(center.x, center.y, radius, middle, tail, false);\r\n                context.stroke();\r\n\r\n                context.beginPath();\r\n                context.strokeStyle = foregroundColor;\r\n                context.arc(center.x, center.y, radius, start, middle, false);\r\n                context.stroke();\r\n            },\r\n\r\n            clear: function () {\r\n                this.context.clearRect(0, 0, this.getWidth(), this.getHeight());\r\n            },\r\n\r\n            update: function () {\r\n                this.create();\r\n            },\r\n\r\n            destroy: function () {\r\n                this.clear();\r\n            },\r\n\r\n            getRadius: function () {\r\n                var center = this.getCenter();\r\n                return center.x - this.getThickness();\r\n            },\r\n\r\n            getCenter: function () {\r\n                var x = this.getWidth() / 2,\r\n                    y = this.getHeight() / 2;\r\n                return {\r\n                    x: x,\r\n                    y: y\r\n                };\r\n            },\r\n\r\n            getValue: function () {\r\n                var val = 0;\r\n                if (this.options.used && this.options.total) {\r\n                    val = (this.options.used / this.options.total) * 100;\r\n                    this.options.value = this.options.used;\r\n                } else {\r\n                    val = this.options.value;\r\n                }\r\n                return val;\r\n\r\n            },\r\n            getWidth: function () {\r\n                return this.context.canvas.width;\r\n            },\r\n\r\n            getHeight: function () {\r\n                return this.context.canvas.height;\r\n            },\r\n\r\n            getThickness: function () {\r\n                return this.options.thick;\r\n            },\r\n\r\n            getBackgroundColor: function () {\r\n                return this.options.backgroundColor;\r\n            },\r\n\r\n            getForegroundColor: function () {\r\n                return this.options.foregroundColor;\r\n            },\r\n\r\n            getLineCap: function () {\r\n                return this.options.cap;\r\n            },\r\n\r\n            getType: function () {\r\n                return this.options.type;\r\n            },\r\n\r\n            getDuration: function () {\r\n                return this.options.duration;\r\n            },\r\n\r\n            clamp: function (value, min, max) {\r\n                return Math.max(min, Math.min(max, value));\r\n            }\r\n\r\n        };\r\n\r\n\r\n        return {\r\n            restrict: 'E',\r\n            replace: true,\r\n            template: tpl,\r\n            scope: {\r\n                append: '@?',\r\n                backgroundColor: '@?',\r\n                cap: '@?',\r\n                foregroundColor: '@?',\r\n                label: '@?',\r\n                prepend: '@?',\r\n                size: '@?',\r\n                thick: '@?',\r\n                type: '@?',\r\n                duration: '@?',\r\n                value: '=?',\r\n                used: '=?',\r\n                total: '=?'\r\n\r\n            },\r\n            link: function (scope, element) {\r\n                var defaults = ngGauge.getOptions(); // fetching default settings from provider\r\n                scope.value = angular.isDefined(scope.value) ? scope.value : defaults.value;\r\n                scope.size = angular.isDefined(scope.size) ? scope.size : defaults.size;\r\n                scope.cap = angular.isDefined(scope.cap) ? scope.cap : defaults.cap;\r\n                scope.thick = angular.isDefined(scope.thick) ? scope.thick : defaults.thick;\r\n                scope.type = angular.isDefined(scope.type) ? scope.type : defaults.type;\r\n                scope.duration = angular.isDefined(scope.duration) ? scope.duration : defaults.duration;\r\n                scope.foregroundColor = angular.isDefined(scope.foregroundColor) ? scope.foregroundColor : defaults.foregroundColor;\r\n                scope.backgroundColor = angular.isDefined(scope.backgroundColor) ? scope.backgroundColor : defaults.backgroundColor;\r\n\r\n                var gauge = new Gauge(element, scope);\r\n\r\n                scope.$watch('value', watchData, false);\r\n                scope.$watch('used', watchData, false);\r\n                scope.$watch('total', watchData, false);\r\n                scope.$watch('cap', watchOther, false);\r\n                scope.$watch('thick', watchOther, false);\r\n                scope.$watch('type', watchOther, false);\r\n                scope.$watch('size', watchOther, false);\r\n                scope.$watch('duration', watchOther, false);\r\n                scope.$watch('foregroundColor', watchOther, false);\r\n                scope.$watch('backgroundColor', watchOther, false);\r\n\r\n                scope.$on('$destroy', function () { });\r\n                scope.$on('$resize', function () { });\r\n\r\n                function watchData(nv, ov) {\r\n                    if (!gauge) return;\r\n                    if (!nv || angular.equals(nv, ov)) return;\r\n                    gauge.update();\r\n                }\r\n\r\n                function watchOther(nv, ov) {\r\n                    if (!gauge) return;\r\n                    if (!nv || angular.equals(nv, ov)) return;\r\n                    gauge.destroy();\r\n                    gauge.init();\r\n                }\r\n            }\r\n        };\r\n\r\n    }\r\n}(angular));\r\n"]}